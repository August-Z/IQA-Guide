# 版本更新（老用户必看）

### AVG 指令模块修改
A. `avg.animation` 不再是默认同步运行
```ruby 
; 同步运行，即 BG2 图层 x 值向 100 进行运动，耗时 1000ms 后，脚本可继续向下运行
#avg.animation BG2 x=100 time=1000

; 异步运行，不论该行指令是否运行成功、或运行完成，脚本都将继续向下运行
@avg.animation BG2 x=100 time=1000
```  
B. 图层属性名有小部分拓展与调整（详见 avg 各指令）  
C. v2 的图层指令被废弃 (如 in、action、motion)

--- 

### 流程控制相关修改
A. [var](../指令大全/赋值操作指令/var.md) 指令现在有更丰富的使用方式；  
B. 新增 [calc](../指令大全/赋值操作指令/calc.md) 指令为数字类型的变量提供运算支持；  
C. [if](../指令大全/赋值操作指令/if.md) 指令参数调整；  
D. [sel](../指令大全/流程控制指令/sel.md) 指令参数调整。

--- 

### 新增运行符功能
A. 得益于 **v3.0 avg 模块的优秀设计**，我们发现同步动画具有高可用性，于是这个功能被抽离成了运行符，供开发者自主控制。  
[运行符](../语句结构/runSymbol.md)主要含有：**同步符号 `#`、异步符 `@` **两种模式（如指令不具有异步模式，使用异步符将视作同步模式解析）  

**<font color=#ea6a6e>同步符可以使脚本以「阻塞模式」运行，适合控制具有耗时操作的指令（等待用户行为也是一种耗时）</font>**。    
    
>如下方可保证图层成功加载图片后、再继续加载音频  
（此处音频因为是异步加载，故不论加载进度是否完成，演出都将继续向下）  

```ruby
@avg.create BG1 
#avg.set BG1 url=iqing
@play BGM1 url=pv time=500
Hello IQA-Eninge V3[r][p]
```   
>这里举一个使图层进行“无限抖动”的栗子🌰：  
  
```ruby
@avg.create FG5
#avg.set FG5 url=对话框 x=-30 y=0 alpha=0
@avg.animation FG5 alpha=0.2 time=800
@avg.animation FG5 x=0 chain alpha=1 time=1500
@avg.animation FG5 x=5 yoyo repeat=Infinity time=33
对话框显示出来咯～[p]
```
这段脚本的运行结果会是（1～3）：  
1. 图层加载资源成功后，设置坐标且完全透明；
2. 同时运行 (a) 与 (b)，对话框开始显示文字“对话框显示出来咯～”；  
3. 图层待 (a) 运行完后，图层运动成 100% 不透明度(耗时 1500ms)。  

a. 图层运动成 20% 不透明度(耗时 800ms)；  
b. 图层 x 在 0～5 之间进行运动，次数无限(每次耗时 33ms)。  

> **如果暂时不能很好地使用同步符，老版本的开发者可暂时照旧使用"@"异步符号进行开发，在使用新版本的过程中渐进学习。**  
**但 IQA 推荐您尽早掌握这个重要概念，熟练的异同符使用对您的演绘开发将是事半功倍！**
